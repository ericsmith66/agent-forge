<% content_for(:title, "Dashboard â€” Agent-Forge") %>

<div class="flex flex-col h-screen bg-base-100">
  <!-- Top Navbar -->
  <%= render Shared::NavbarComponent.new(project: @project, projects: @projects, current_task: @current_task) %>

  <!-- Main 3-pane layout -->
  <div class="flex-1 flex overflow-hidden min-h-0">
    <%# 1. Left Sidebar: Artifact Tree %>
    <aside class="w-[280px] bg-base-200 border-r border-base-300 flex flex-col shrink-0">
      <div class="flex-1 overflow-hidden">
        <% if @project %>
          <%= turbo_frame_tag "artifact_tree" do %>
            <%= render Artifacts::TreeComponent.new(project: @project) %>
          <% end %>
        <% end %>
      </div>
    </aside>

    <%# 2. Center: Chat Pane %>
    <main id="main-content" class="flex-1 flex flex-col min-w-[400px] border-r border-base-300">
      <% if @project && @current_task %>
        <%= render Chat::InterfaceComponent.new(task: @current_task) %>
      <% elsif @project %>
        <div class="flex-1 flex items-center justify-center p-8 text-center bg-base-100">
          <div>
            <h3 class="text-lg font-bold">No Active Tasks</h3>
            <p class="text-base-content/50">Start a new task to begin building.</p>
          </div>
        </div>
      <% else %>
        <div class="flex-1 flex items-center justify-center">
          <p>Select or create a project to start.</p>
        </div>
      <% end %>
    </main>

    <%# 3. Right: Viewer/Editor Pane %>
    <aside class="w-[480px] bg-base-100 flex flex-col shrink-0 overflow-hidden border-l border-base-300">
      <turbo-frame id="artifact_viewer">
        <div class="flex flex-col h-full items-center justify-center text-center p-8 text-base-content/30 italic">
          <i data-lucide="file-search" class="w-12 h-12 mb-4 opacity-20"></i>
          <p>Select an artifact from the tree to view or edit it.</p>
        </div>
      </turbo-frame>
    </aside>
  </div>
</div>
